
class StatsReport:
    def __init__(self, nmap_result):
        self.nmap_result = nmap_result
    
    def getnumberofhosts(self):
        return len(self.nmap_result.hosts)
    
    def getservicestats(self):
        result = {}
        for host in self.nmap_result.hosts:
            for port in host.ports:
                if port.service.name in result.keys():
                    result[port.service.name] += 1
                else:
                    result[port.service.name] = 1
                # print(port.service_name)
        return result
    
    def markdown(self):
        result = "# Stats\n\n"

        result += "## General\n\n"
        result += "| DESCRIPTION | RESULT |\n"
        result += "| --- | --- |\n"
        result += "| Number of hosts | %i |\n" % (self.getnumberofhosts())
        result += "\n" 

        result += "## Services\n\n"
        result += "| SERVICE | NUMBER |\n"
        result += "| --- | --- |\n"
        services = self.getservicestats()
        for service in services.keys():
            result += "| %s | %i |\n" % (service, services[service])
        result += "\n"
        
        return result

