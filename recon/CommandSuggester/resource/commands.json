{
    "ssh": {
        "commands": [
            "# Bruteforce attack - LOGIN=PASS\nhydra -t 4 -vV -L /usr/share/metasploit-framework/data/wordlists/unix_users.txt -e s -w 5 -s {TARGET_PORT} {TARGET_HOST} ssh | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_ssh_hydra.log",
            "# Bruteforce attack - LOGIN=PASS\nhydra -t 4 -vV -L ./wordlists/users.txt -e s -w 5 -s {TARGET_PORT} {TARGET_HOST} ssh | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_ssh_hydra.log"
        ],
        "commands-multi": [
            "# Bruteforce attack - LOGIN=PASS\nhydra -t 4 -vV -M ./targets/hosts_ssh.txt -L ./wordlists/users.txt -e s -w 5 ssh | tee -a {LOGDIR}/ssh_hydra.log"
        ]
    },

    "ftp": {
        "commands": [
            "nmap --script=ftp-anon,ftp-bounce,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor -p {TARGET_PORT} {TARGET_HOST} -oN {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_ftp_nmap.log",
            "# Bruteforce attack - LOGIN=PASS\nhydra -t 4 -vV -L /usr/share/metasploit-framework/data/wordlists/unix_users.txt -e s -s {TARGET_PORT} {TARGET_HOST} ftp | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_ftp_hydra.log"
        ]
    },

    "smtp": {
        "commands": [
            "# Enumerate users and commands and check open relay with nmap\nnmap --script=smtp-enum-users,smtp-open-relay,smtp-commands -p {TARGET_PORT} {TARGET_HOST} -oN {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_smtp_nmap.log"
        ]
    },

    "domain": {
        "commands": [
            "# Get the domain corresponding to an IP address\ndig -x {TARGET_HOST} @{TARGET_HOST} | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_dns_dig.log",
            "# Zone transfer using dig\ndig axfr blah.com @{TARGET_HOST} | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_dns_dig.log",
            "dnsrecon -d DOMAIN -D /usr/share/wordlists/dnsmap.txt -t std -n {TARGET_HOST} | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_dns_dnsrecon.log"
        ]
    },

    "http": {
        "commands": [
            "wfuzz -f {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_http_wfuzz_common.log,raw --hc 404 -c -z file,/usr/share/dirb/wordlists/common.txt {TARGET_PROTO}://{TARGET_HOST}:{TARGET_PORT}/FUZZ",
            "wfuzz -f {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_http_wfuzz_medium.log,raw --hc 404 -c -z file,/usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt {TARGET_PROTO}://{TARGET_HOST}:{TARGET_PORT}/FUZZ",
            "wfuzz -f {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_http_wfuzz_common-ext.log,raw --hc 404 -c -z file,/usr/share/dirb/wordlists/common.txt -z list,.php-.html- {TARGET_PROTO}://{TARGET_HOST}:{TARGET_PORT}/FUZZFUZ2Z",
            "wfuzz -f {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_http_wfuzz_medium-ext.log,raw --hc 404 -c -z file,/usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -z list,.php-.html- {TARGET_PROTO}://{TARGET_HOST}:{TARGET_PORT}/FUZZFUZ2Z",
            "nikto -C all -o {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_http_nikto.log -h {TARGET_PROTO}://{TARGET_HOST}:{TARGET_PORT}/",
            "# VHOST enumeration using wfuzz\nwfuzz -f {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_http_wfuzz_vhosts.log,raw -c -z file,/usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -H \"Host: FUZZ.TARGET.TLD\" --hh NN {TARGET_HOST}:{TARGET_HOST}"
        ]
    },

    "kerberos-sec": {
        "commands": [
            "# ASREPRoast - single user - Change DOMAIN-FQN and DOMAIN-USER\nGetNPUsers.py \"DOMAIN-FQN/DOMAIN-USER\" -no-pass | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_kerberos_impacket.log",
            "# ASREPRoast - multiple users - Change DOMAIN-FQDN\nfor i in $(cat ./wordlists/users.txt); do GetNPUsers.py \"DOMAIN-FQDN/$i\" -no-pass; done | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_kerberos_impacket.log",
            "# Kerberoast - Auth required - Change DOMAIN-FQDN, DOMAIN-USER and DOMAIN-PASS\nGetUserSPNs.py -request -dc-ip {TARGET_HOST} DOMAIN-FQDN/DOMAIN-USER:DOMAIN-PASS | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_kerberos_impacket.log"
        ]
    },

    "rpcbind": {
        "commands": [
            "rpcinfo -p {TARGET_HOST} | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_rpcbind_rpcinfo.log"
        ]
    },

    "ldap": {
        "commands": [
            "# Get naming context\nldapsearch -x -h {TARGET_HOST} -p {TARGET_PORT} -LLL -s base -b \"\" namingContexts | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_ldap_ldapsearch.log",
            "# Attempt null bind - Replace NAMING_CONTEXT with the result of the first command\nldapsearch -x -h {TARGET_HOST} -p {TARGET_PORT} -b NAMING_CONTEXT | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_ldap_ldapsearch.log"
        ]
    },

    "microsoft-ds": {
        "commands": [
            "nmap -vv -p139,445 --script smb-enum-domains.nse,smb-enum-groups.nse,smb-enum-processes.nse,smb-enum-sessions.nse,smb-enum-shares.nse,smb-enum-users.nse,smb-ls.nse,smb-mbenum.nse,smb-os-discovery.nse,smb-print-text.nse,smb-psexec.nse,smb-security-mode.nse,smb-server-stats.nse,smb-system-info.nse,smb-vuln-* {TARGET_HOST} | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_smb_nmap.log",
            "enum4linux -a {TARGET_HOST} | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_smb_enum4linux.log",
            "nmblookup -A {TARGET_HOST} | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_smb_nmblookup.log",
            "smbmap -H {TARGET_HOST} | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_smb_smbmap.log",
            "nbtscan {TARGET_HOST} | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_smb_nbtscan.log",
            "smbclient -L {TARGET_HOST} | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_smb_smbclient.log",
            "cme smb {TARGET_HOST} | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_smb_cme.log",
            "cme smb {TARGET_HOST} -u '' -p '' --local-auth | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_smb_cme.log",
            "cme smb {TARGET_HOST} -u 'Guest' -p '' --local-auth --shares | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_smb_cme.log",
            "# Bruteforce attack - LOGIN=PASS\nhydra -t 4 -vV -L ./wordlists/users.txt -e s -w 5 -s {TARGET_PORT} {TARGET_HOST} smb | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_smb_hydra.log",
            "# Bruteforce attack - Password spraying\nhydra -t 4 -vV -L ./wordlists/users.txt -p 'PASSWORD' -e s -w 5 -s {TARGET_PORT} {TARGET_HOST} smb | tee -a {LOGDIR}/{TARGET_HOST}-{TARGET_PORT}_smb_hydra.log"
        ]
    }
}
